<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil de Usuario - Visenture Access</title>
    <link rel="stylesheet" href="profile.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-slate-900 text-gray-200 min-h-screen flex flex-col">
    <div id="header-placeholder"></div>
    <div id="content-placeholder"></div>
    <div id="footer-placeholder"></div>

    <!-- Scripts del sidebar -->
    <script src="../app/sidebar.js" defer></script>
    <script src="../app/dropdown-handler.js" defer></script>

    <script>
        // Cargar el header primero
        fetch('../app/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
                // Cuando el header se ha cargado, inicializar el sidebar
                if (typeof initSidebar === 'function') {
                    console.log('Llamando a initSidebar después de cargar el header');
                    setTimeout(initSidebar, 100);
                }
            });
            
        // Cargar el contenido principal y footer
        fetch('profile.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('content-placeholder').innerHTML = data;
                console.log("Contenido de perfil cargado");
                // Inicializar la funcionalidad del perfil
                setTimeout(initProfileFunctionality, 100);
            })
            .catch(error => console.error('Error cargando el contenido de perfil:', error));
            
        // Cargar el pie de página
        fetch('../app/footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer-placeholder').innerHTML = data;
            })
            .catch(error => console.error('Error cargando el footer:', error));

        /*--------------------------------------------------
          FUNCIONALIDAD DE PESTAÑAS DEL PERFIL
        --------------------------------------------------*/
        function initProfileFunctionality() {
            const tabButtons = document.querySelectorAll('[data-tab]');
            const tabContents = document.querySelectorAll('[id$="Content"]');
            
            if (tabButtons.length === 0) {
                console.log('Los botones de tab no han sido cargados aún, reintentando...');
                setTimeout(initProfileFunctionality, 100);
                return;
            }
            
            console.log('Inicializando la funcionalidad del perfil');
            
            /*--------------------------------------------------
              GESTIÓN DE VISUALIZACIÓN DE PESTAÑAS
            --------------------------------------------------*/
            function showTab(tabId) {
                // Desactivar todos los botones
                tabButtons.forEach(button => {
                    button.classList.remove('bg-emerald-900', 'text-emerald-300', 'font-medium');
                });
                
                // Ocultar todos los contenidos
                tabContents.forEach(content => {
                    content.style.display = 'none';
                });
                
                // Activar el botón seleccionado
                const activeButton = document.querySelector(`[data-tab="${tabId}"]`);
                if (activeButton) {
                    activeButton.classList.add('bg-emerald-900', 'text-emerald-300', 'font-medium');
                }
                
                // Mostrar el contenido correspondiente
                const activeContent = document.getElementById(`${tabId}Content`);
                if (activeContent) {
                    activeContent.style.display = 'block';
                }
            }
            
            // Asignar evento click a cada botón
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    showTab(tabId);
                });
            });
            
            // Mostrar la primera tab por defecto
            showTab('information');
        }

        // Ejecutar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', loadInterface);
    </script>
</body>
</html>